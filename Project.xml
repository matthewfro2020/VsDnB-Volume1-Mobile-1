<?xml version="1.0" encoding="utf-8"?>
<project>

    <app title="VS. Dave and Bambi"
         file="VsDave"
         packageName="dnbteam.daveandbambi"
         package="dnbteam.daveandbambi"
         main="Main"
         version="1.0.7"
         company="dnbteam" />

    <app preloader="flixel.system.FlxPreloader"/>
    <set name="SWF_VERSION" value="11.8"/>

    <!-- Window -->
    <window width="1280" height="720" fps="120" hardware="true" vsync="true"/>
    <window if="mobile" fullscreen="true" allow-high-dpi="true"/>

    <!-- Paths -->
    <classpath name="source"/>

    <assets path="assets/preload" rename="assets"/>
    <assets path="assets/preload/videos" rename="assets/videos" include="*.mp4" embed="false"/>
    <assets path="assets/songs" library="songs"/>
    <assets path="assets/shared" library="shared"/>
    <assets path="assets/fonts" embed="true"/>
    <assets path="mobile" rename="assets/mobile" if="mobile"/>

    <!-- Preload -->
    <define name="PRELOAD_ALL"/>
    <library name="songs" preload="true"/>
    <library name="shared" preload="true"/>

    <!-- Mobile-safe libs -->
    <haxelib name="flixel"/>
    <haxelib name="flixel-ui"/>
    <haxelib name="flixel-addons"/>
    <haxelib name="openfl"/>
    <haxelib name="lime"/>
    <haxelib name="hxvlc" if="android"/>
    <haxelib name="flxanimate"/>
    <haxelib name="json2object"/>
    <haxelib name="polymod"/>
    <haxelib name="hscript"/>

    <!-- Desktop only libs removed: funkin.vis / grig.audio -->

    <!-- Safety defines -->
    <haxedef name="HXCPP_NO_NIL"/>
    <haxedef name="HXCPP_NO_PCH"/>
    <haxedef name="HXCPP_STACK_TRACE"/>
    <haxedef name="HXCPP_STACK_LINE"/>
    <haxedef name="HXCPP_CHECK_POINTER"/>

    <haxeflag name="-dce no"/>

    <!-- Remove ALL macros for Mobile -->
    <haxedef name="NO_MACROS" if="mobile"/>

    <section unless="NO_MACROS">
        <haxeflag name="--macro" value="include('api')"/>
        <haxeflag name="--macro" value="include('audio')"/>
        <haxeflag name="--macro" value="include('backend')"/>
        <haxeflag name="--macro" value="include('controls')"/>
        <haxeflag name="--macro" value="include('data')"/>
        <haxeflag name="--macro" value="include('graphics')"/>
        <haxeflag name="--macro" value="include('modding')"/>
        <haxeflag name="--macro" value="include('play')"/>
        <haxeflag name="--macro" value="include('scripting')"/>
        <haxeflag name="--macro" value="include('ui')"/>
        <haxeflag name="--macro" value="include('util')"/>
    </section>

    <!-- Android -->
    <section if="android">
        <config>
            <android gradle-version="7.4.2" gradle-plugin="7.3.1"/>
            <android platform="android-33"/>
            <android min-sdk-version="16"/>
            <android target-sdk-version="30"/>
            <android abi="armeabi-v7a"/>
            <android bundle="false"/>
        </config>
    </section>

    <!-- iOS -->
    <section if="ios">
        <define name="objc"/>
        <ios linker-flags="-ObjC"/>
    </section>

</project>
